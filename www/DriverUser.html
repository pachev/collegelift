<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title></title>

        <link href="lib/ionic/css/ionic.css" rel="stylesheet">
        <link href="css/style.css" rel="stylesheet">
        <script src="controllers.js"></script>



        <!-- IF using Sass (run gulp sass first), then uncomment below and remove the CSS includes above
        <link href="css/ionic.app.css" rel="stylesheet">
        -->

        <!-- ionic/angularjs js -->
        <script src="lib/ionic/js/ionic.bundle.js"></script>

        <!-- cordova script (this will be a 404 during development) -->
        <script src="cordova.js"></script>
        <script src="js/main.js"></script>

        <!-- your app's js -->
        <script src="js/app.js"></script>
    </head>
    <body ng-app="starter" id="driverPage">

        <div class="bar bar-header">
          <a href="DriverUser.html" class="pull-right"> 
            <button class="button button-clear button-positive"><i class="icon ion-android-home"></i></button>
          </a>
          <a href="payment.html"> 
            <button class="button button-clear button-positive"> <i class="icon ion-social-usd"></i> </button>
          </a>

          <div class="h1 title">User</div>
          <div class="pull-left" id="pullit"><a href="index.html"> <button class="button button-clear button-positive">logout </button> </a></div>
        </div>

        <div class="center-block" id="GetDown">
                <div id="map"></div>
               <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false&libraries=geometry"></script>
                <script>
                    var map;
                    function initMap() {
                        map = new google.maps.Map(document.getElementById('map'), {
                            center: {lat: 25.759761, lng: -80.374007},
                            zoom: 13
                        });
                    }
      var map;
      var iconBase = 'https://maps.google.com/mapfiles/kml/shapes/';
      var event_markerLatLong;
      var user1LatLong = {
        lat: 26.026339
        , lng: -80.321689
      }
      var user2LatLong = {
        lat: 25.937041
        , lng: -80.162589
      }
      var theUrl = 'http://www.miamibeachapi.com/rest/a.pi/events/search';
      var consumerKey = "anonymous";
      var consumerSecret = "anonymous";
      var token = "98c4b6475d90528e2b8fce39ced022a94290d558";
      var tokenSecret = "d18bf609d7c3ce5d2a0c221edde42a6decf23c3b";
      var eventArray = new Array();
      var eventTitleArray = new Array();
      var accessor = {
        consumerKey: consumerKey
        , consumerSecret: consumerSecret
        , token: token
        , tokenSecret: tokenSecret
      };
      var message = {
        method: "GET"
        , action: theUrl
        , parameters: {}
      };
      message.parameters = {};
      message.parameters['rows'] = 35;
      message.parameters['page'] = 1;
      message.parameters['keyword'] = 'fun';
      message.parameters['jsoncallback'] = '?';
      message.parameters['oauth_timestamp'] = freshTimestamp();
      message.parameters['oauth_nonce'] = freshNonce();
      OAuth.completeRequest(message, accessor);
      OAuth.SignatureMethod.sign(message, accessor);
      var encodedParams = OAuth.formEncode(message.parameters);
      var getURL = theUrl + '?' + encodedParams;
      $.getJSON(getURL, function (data) {
        var outHTML = "";
        if (data.events) {
          $.each(data.events, function (i, e) {
            if (e.lat == undefined) {
              return true;
            }
            eventArray.push("{lat:" + e.lat + ", lng:" + e.lng + "}");
            eventTitleArray.push(e.name);
            
          });
        }
        
        
      });
      function freshTimestamp() {
        return OAuth.timestamp();
      }
      function freshNonce() {
        return OAuth.nonce(11);
      }
      event_markerLatLong = eventArray[3];
      console.log(eventArray[3]);
      function initMap() {
  
        
        
        console.log(eventArray);
        //event_markerLatLong = eventArray.pop();
        map = new google.maps.Map(document.getElementById('map'), {
          center: {
            lat: 25.911747
            , lng: -80.139883
          }
          , zoom: 12
        });
        var user1_marker = new google.maps.Marker({
          position: user1LatLong
          , map: map
          , title: 'You are Here'
        });
        var user2_marker = new google.maps.Marker({
          position: user2LatLong
          , map: map
          , title: 'Needs a ride'
          
          , animation: google.maps.Animation.DROP
        });
        var event_marker = new google.maps.Marker({
          position: {
            lat: 25.79135
            , lng: -80.13323
          }
          
          , map: map
          , title: 'Check this out' 
          //, labelContent: eventTitleArray[3]
          , icon: 'img/calendar.png'
          , animation: google.maps.Animation.DROP
        });
        var event_marker2 = new google.maps.Marker({
          position: {
            lat: 25.85913
            , lng: -80.12014
          }
          
          , map: map
          , title: 'Check this out' 
          //, labelContent: eventTitleArray[3]
          , icon: 'img/calendar.png'
          , animation: google.maps.Animation.DROP
        });
          var event_marker3 = new google.maps.Marker({
          position: {
            lat: 25.78333
            , lng: -80.13196
          }
          
          , map: map
          , title: 'Check this out' 
          //, labelContent: eventTitleArray[3]
          , icon: 'img/calendar.png'
          , animation: google.maps.Animation.DROP
        });
      }


              var p1 = new google.maps.LatLng(26.026339,  -80.321689);
              var p2 = new google.maps.LatLng(25.937041,  -80.162589);

              var message = document.getElementById("miles");
              //calculates distance between two points in km's
              function calcDistance(p1, p2){
              var distnace = (google.maps.geometry.spherical.computeDistanceBetween(p1, p2) / 1000).toFixed(2);
              }
              message.value = distance;
                </script>
                <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCzZ7gECjSSLqNO3xFDZT3nczedPvLBxqU&callback=initMap"
                async defer></script>

            </div>   
        </div>
  <div class="container-fluid" id="Passangers">
    <div class="row">
    <div class="col col-33">
      <img class="img-circle" width="35px"src="https://upload.wikimedia.org/wikipedia/en/d/d8/Michael_J._Fox_as_Marty_McFly_in_Back_to_the_Future,_1985.jpg">
      <a href=""><h4> Marty McFly </h4></a>
      <div id="miles"></div> <script type="text/javascript">document.write(distnace);</script>
      <p> 5 miles from your Location <p>
      </div>

    <div class="col col-33">
      <img class="img-circle" width="35px"src="http://vignette2.wikia.nocookie.net/epicrapbattlesofhistory/images/b/b5/Doc_Brown_Based_On.png/revision/latest?cb=20150823032635">
      <a href=""><h4> Emmett Brown Doc </h4></a>
      <p> 10 miles from your Location <p>
      </div>
      <div class="col col-33">
      <img class="img-circle" width="40px" src="http://www.laprensalibre.cr/files/noticias/images/detail/1665033599_barackobamalookalikewantsprivacyandbarmitzvahgigs223a5782e9.jpg">
      <a href=""><h4> Barack Obama </h4></a>
      <p> 15 miles from your Location <p>
      </div>
    </div>
    </div>
  </div>
                                    <script src="js/main.js"></script>
                                    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
                                    </body>
                                    </html>